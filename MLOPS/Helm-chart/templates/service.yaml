apiVersion: v1
kind: Service
metadata:
  name: {{ include "ml-inference.fullname" . }} # Name of the Service
  labels:
    {{- include "ml-inference.labels" . | nindent 4 }}
spec:
  # The type of Service defined in values.yaml (e.g., ClusterIP for internal, LoadBalancer for external)
  type: {{ .Values.service.type }} 
  ports:
    - port: {{ .Values.service.port }} # External port the Service is exposed on (e.g., 80)
      targetPort: http                   # Name of the container port (defined in deployment.yaml)
      protocol: TCP
      name: http
  # CRITICAL: This selector links the Service to the correct Deployment pods
  selector:
    {{- include "ml-inference.selectorLabels" . | nindent 4 }}
    # This specific label must match the label applied to the Deployment's template
    app.kubernetes.io/instance: {{ .Release.Name }}
  